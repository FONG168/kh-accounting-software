{% extends "base.html" %}
{% block title %}Business Setup — KH Accounting Software Enterprise{% endblock %}
{% block extra_css %}
<style>
    .setup-hero { text-align: center; margin-bottom: 2.5rem; }
    .setup-hero h2 { font-weight: 700; font-size: 1.8rem; }
    .setup-hero p { color: #64748b; font-size: 1.05rem; max-width: 560px; margin: .5rem auto 0; }
    .industry-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1rem; }
    .industry-card {
        border: 2px solid #e2e8f0; border-radius: .75rem;
        padding: 1.3rem 1rem; text-align: center; cursor: pointer;
        transition: all .2s;
    }
    .industry-card:hover { border-color: #3b82f6; background: #f0f7ff; transform: translateY(-2px); }
    .industry-card.selected { border-color: #3b82f6; background: #eff6ff; box-shadow: 0 0 0 3px rgba(59,130,246,.25); }
    .industry-card .card-icon { font-size: 2rem; color: #3b82f6; margin-bottom: .5rem; }
    .industry-card .card-name { font-weight: 600; font-size: .95rem; }
    .industry-card .card-desc { font-size: .78rem; color: #64748b; margin-top: .25rem; }
    .setup-form { max-width: 500px; margin: 2rem auto 0; }
    #industryInput { display: none; }
</style>
{% endblock %}
{% block content %}
<div class="setup-hero">
    <h2><i class="bi bi-rocket-takeoff me-2"></i>Welcome to KH Accounting Software Enterprise</h2>
    <p>Let's set up your business. Choose your industry so we can configure the right categories, chart of accounts, and reports for you.</p>
</div>

<form method="POST" id="setupForm">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <input type="hidden" name="industry" id="industryInput" value="{{ settings.industry if settings else '' }}">

    <!-- Step 1 — Company Info -->
    <div class="setup-form mb-4">
        <div class="row g-3">
            <div class="col-md-8">
                <label class="form-label fw-semibold">Company Name *</label>
                <input type="text" name="company_name" class="form-control form-control-lg" placeholder="Your business name"
                       value="{{ settings.company_name if settings else '' }}" required>
            </div>
            <div class="col-md-4">
                <label class="form-label fw-semibold">Currency</label>
                <input type="text" name="currency_symbol" class="form-control form-control-lg" maxlength="5"
                       value="{{ settings.currency_symbol if settings else '$' }}" placeholder="$">
            </div>
        </div>
    </div>

    <!-- Step 2 — Industry Selection -->
    <h5 class="text-center fw-semibold mb-3"><i class="bi bi-grid-3x3-gap me-1"></i>Select Your Industry</h5>
    <div class="industry-grid">
        {% for key, ind in industries.items() %}
        <div class="industry-card {% if settings and settings.industry == key %}selected{% endif %}"
             data-industry="{{ key }}" onclick="selectIndustry(this, '{{ key }}')">
            <div class="card-icon"><i class="bi {{ ind.icon }}"></i></div>
            <div class="card-name">{{ ind.name }}</div>
            <div class="card-desc">{{ ind.desc }}</div>
        </div>
        {% endfor %}
    </div>

    <div class="text-center mt-4 mb-5">
        <button type="submit" class="btn btn-primary btn-lg px-5" id="continueBtn" disabled>
            <i class="bi bi-check-lg me-1"></i>Set Up My Business
        </button>
    </div>
</form>

{% endblock %}
{% block extra_js %}
<script>
function selectIndustry(el, key) {
    document.querySelectorAll('.industry-card').forEach(c => c.classList.remove('selected'));
    el.classList.add('selected');
    document.getElementById('industryInput').value = key;
    document.getElementById('continueBtn').disabled = false;
}
</script>
{% endblock %}
