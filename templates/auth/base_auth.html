<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}KH Accounting Software Enterprise{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
            display: flex;
            background: #070b14;
            overflow-x: hidden;
        }

        /* ── Animated mesh background ── */
        .auth-bg-canvas {
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background:
                radial-gradient(ellipse 80% 60% at 10% 80%, rgba(59,130,246,.12) 0%, transparent 70%),
                radial-gradient(ellipse 60% 50% at 90% 20%, rgba(99,102,241,.10) 0%, transparent 70%),
                radial-gradient(ellipse 50% 40% at 50% 50%, rgba(14,165,233,.06) 0%, transparent 70%);
        }

        /* Floating orbs */
        .auth-orb {
            position: fixed; border-radius: 50%; filter: blur(80px); opacity: .35;
            pointer-events: none; z-index: 0;
            animation: orbFloat 18s ease-in-out infinite alternate;
        }
        .auth-orb-1 { width: 400px; height: 400px; background: #3b82f6; top: -10%; left: -8%; animation-duration: 20s; }
        .auth-orb-2 { width: 350px; height: 350px; background: #6366f1; bottom: -12%; right: -5%; animation-duration: 24s; animation-delay: -6s; }
        .auth-orb-3 { width: 250px; height: 250px; background: #0ea5e9; top: 40%; left: 30%; animation-duration: 22s; animation-delay: -10s; opacity: .18; }

        @keyframes orbFloat {
            0%   { transform: translate(0, 0) scale(1); }
            33%  { transform: translate(30px, -20px) scale(1.05); }
            66%  { transform: translate(-20px, 15px) scale(.95); }
            100% { transform: translate(15px, -10px) scale(1.02); }
        }

        /* ── Grid pattern overlay ── */
        .auth-grid-overlay {
            position: fixed; inset: 0; z-index: 0; pointer-events: none; opacity: .03;
            background-image:
                linear-gradient(rgba(255,255,255,.5) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,.5) 1px, transparent 1px);
            background-size: 60px 60px;
        }

        /* ── Left branding panel ── */
        .auth-brand {
            flex: 0 0 480px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 3.5rem;
            color: #fff;
            position: relative;
            z-index: 1;
        }

        .auth-brand .brand-logo {
            position: relative;
            display: flex;
            align-items: center;
            gap: 16px;
            animation: fadeSlideUp .7s ease-out;
        }
        .auth-brand .brand-logo .auth-monogram {
            width: 64px; height: 64px;
            flex-shrink: 0;
            position: relative;
            display: flex; align-items: center; justify-content: center;
        }
        .auth-monogram .logo-shape {
            position: absolute; inset: 0;
        }
        .auth-monogram .logo-bg {
            width: 100%; height: 100%;
            rx: 18; ry: 18;
            fill: url(#logoGrad);
            filter: drop-shadow(0 6px 20px rgba(59,130,246,.35));
        }
        .auth-monogram .logo-inner-border {
            width: calc(100% - 4px); height: calc(100% - 4px);
            x: 2; y: 2;
            rx: 16; ry: 16;
            fill: none;
            stroke: rgba(255,255,255,.12);
            stroke-width: 1;
        }
        .auth-monogram .logo-shine {
            width: 100%; height: 50%;
            rx: 18; ry: 18;
            fill: url(#logoShine);
        }
        .auth-monogram .logo-letters {
            font-family: 'Inter', sans-serif;
            font-size: 22px;
            font-weight: 900;
            letter-spacing: 1.5px;
            fill: #fff;
            text-anchor: middle;
            dominant-baseline: central;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,.25));
        }
        /* Outer glow ring */
        .auth-monogram::before {
            content: '';
            position: absolute;
            inset: -6px;
            border-radius: 22px;
            background: conic-gradient(
                from 0deg,
                rgba(59,130,246,.3),
                rgba(99,102,241,.15),
                rgba(139,92,246,.3),
                rgba(99,102,241,.15),
                rgba(59,130,246,.3)
            );
            z-index: -1;
            filter: blur(8px);
            opacity: .7;
            animation: logoGlowRotate 8s linear infinite;
        }
        /* Subtle pulse ring */
        .auth-monogram::after {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,.06);
            z-index: 1;
            pointer-events: none;
        }
        @keyframes logoGlowRotate {
            from { filter: blur(8px) hue-rotate(0deg); }
            to   { filter: blur(8px) hue-rotate(360deg); }
        }
        .auth-brand .brand-logo .auth-brand-text { display: flex; flex-direction: column; line-height: 1.2; }
        .auth-brand .brand-logo .auth-brand-text .auth-brand-name {
            font-size: 1.65rem; font-weight: 800; letter-spacing: -0.8px; color: #fff;
            background: linear-gradient(135deg, #ffffff 0%, #cbd5e1 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .auth-brand .brand-logo .auth-brand-text .auth-brand-edition {
            font-size: 0.65rem; font-weight: 700; letter-spacing: 4px; text-transform: uppercase;
            background: linear-gradient(90deg, #3b82f6, #818cf8);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 3px;
        }

        .auth-brand .brand-tagline {
            color: #64748b; font-size: .95rem; margin-top: .75rem;
            position: relative; text-align: center; line-height: 1.6;
            animation: fadeSlideUp .7s ease-out .15s both;
        }

        /* Divider */
        .auth-brand .brand-divider {
            width: 48px; height: 2px; margin: 1.75rem 0;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
            border-radius: 2px;
            animation: fadeSlideUp .7s ease-out .25s both;
        }

        .auth-brand .brand-features {
            position: relative; list-style: none; padding: 0;
            animation: fadeSlideUp .7s ease-out .35s both;
        }
        .auth-brand .brand-features li {
            color: #94a3b8; font-size: .88rem; padding: .55rem 0;
            display: flex; align-items: center; gap: .75rem;
            transition: all .25s ease;
        }
        .auth-brand .brand-features li:hover {
            color: #cbd5e1; transform: translateX(4px);
        }
        .auth-brand .brand-features li .feature-icon {
            width: 28px; height: 28px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: .7rem; flex-shrink: 0;
            background: rgba(34,197,94,.08); border: 1px solid rgba(34,197,94,.15);
        }
        .auth-brand .brand-features li .feature-icon i { color: #22c55e; }

        /* Trust badges */
        .trust-badges {
            display: flex; gap: 1.5rem; margin-top: 2.5rem;
            animation: fadeSlideUp .7s ease-out .5s both;
        }
        .trust-badge {
            display: flex; flex-direction: column; align-items: center; gap: 4px;
        }
        .trust-badge .tb-icon {
            width: 36px; height: 36px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.06);
            font-size: .9rem; color: #64748b;
            transition: all .3s ease;
        }
        .trust-badge:hover .tb-icon {
            background: rgba(59,130,246,.08); border-color: rgba(59,130,246,.2);
            color: #3b82f6; transform: translateY(-2px);
        }
        .trust-badge .tb-label {
            font-size: .6rem; font-weight: 600; letter-spacing: .5px;
            text-transform: uppercase; color: #475569;
        }

        /* ── Right form panel ── */
        .auth-form-panel {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            z-index: 1;
        }

        .auth-card {
            background: rgba(255,255,255,.97);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2.75rem;
            width: 100%;
            max-width: 460px;
            box-shadow:
                0 25px 60px rgba(0,0,0,.35),
                0 0 0 1px rgba(255,255,255,.08),
                inset 0 1px 0 rgba(255,255,255,.6);
            animation: cardAppear .6s ease-out;
            position: relative;
        }

        .auth-card::before {
            content: '';
            position: absolute; top: 0; left: 20%; right: 20%; height: 3px;
            background: linear-gradient(90deg, transparent, #3b82f6, #6366f1, transparent);
            border-radius: 0 0 4px 4px;
        }

        @keyframes cardAppear {
            from { opacity: 0; transform: translateY(20px) scale(.98); }
            to   { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes fadeSlideUp {
            from { opacity: 0; transform: translateY(16px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        .auth-card h2 {
            font-weight: 800; font-size: 1.6rem; margin-bottom: .3rem;
            color: #0f172a; letter-spacing: -0.5px;
        }
        .auth-card .subtitle {
            color: #64748b; font-size: .88rem; margin-bottom: 1.75rem; line-height: 1.5;
        }

        /* Form fields */
        .auth-card .form-label {
            font-weight: 600; font-size: .78rem; color: #475569;
            text-transform: uppercase; letter-spacing: .4px;
            margin-bottom: .4rem;
        }
        .auth-card .form-control {
            border-radius: 12px; border: 1.5px solid #e2e8f0;
            padding: 11px 14px; font-size: .9rem;
            background: #f8fafc;
            transition: all .25s ease;
        }
        .auth-card .form-control:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59,130,246,.1), 0 1px 3px rgba(0,0,0,.06);
            background: #fff;
        }
        .auth-card .form-control::placeholder { color: #94a3b8; }

        .auth-card .input-group-text {
            background: #f1f5f9; border: 1.5px solid #e2e8f0;
            border-right: none; border-radius: 12px 0 0 12px;
            color: #94a3b8; font-size: .9rem;
            transition: all .25s ease;
        }
        .auth-card .input-group:focus-within .input-group-text {
            border-color: #3b82f6; color: #3b82f6; background: #eff6ff;
        }
        .auth-card .input-group .form-control {
            border-radius: 0 12px 12px 0; border-left: none;
        }
        .auth-card .input-group .form-control:focus {
            box-shadow: 0 0 0 4px rgba(59,130,246,.1);
        }

        /* Password toggle */
        .pwd-toggle-btn {
            position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
            background: none; border: none; color: #94a3b8; cursor: pointer;
            padding: 4px; font-size: .9rem; z-index: 5;
            transition: color .2s ease;
        }
        .pwd-toggle-btn:hover { color: #3b82f6; }
        .pwd-field-wrap { position: relative; flex: 1; }
        .pwd-field-wrap .form-control { padding-right: 40px; }

        /* Check / Remember */
        .auth-card .form-check-input {
            border-radius: 5px; border: 1.5px solid #cbd5e1;
            width: 1.1em; height: 1.1em;
        }
        .auth-card .form-check-input:checked {
            background-color: #3b82f6; border-color: #3b82f6;
        }
        .auth-card .form-check-label {
            font-size: .84rem; color: #64748b; font-weight: 500;
        }

        /* Primary button */
        .auth-card .btn-primary {
            width: 100%; padding: 12px; border-radius: 12px;
            font-weight: 700; font-size: .95rem; letter-spacing: .2px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%);
            border: none;
            box-shadow: 0 4px 16px rgba(37,99,235,.35), 0 1px 3px rgba(0,0,0,.08);
            transition: all .3s ease;
            position: relative;
            overflow: hidden;
        }
        .auth-card .btn-primary::before {
            content: '';
            position: absolute; inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,.15), transparent 60%);
            pointer-events: none;
        }
        .auth-card .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8, #1e40af);
            box-shadow: 0 8px 24px rgba(37,99,235,.45), 0 2px 6px rgba(0,0,0,.1);
            transform: translateY(-1px);
        }
        .auth-card .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(37,99,235,.3);
        }

        /* Footer */
        .auth-card .auth-footer {
            text-align: center; margin-top: 1.5rem;
            font-size: .85rem; color: #64748b;
        }
        .auth-card .auth-footer a {
            color: #3b82f6; text-decoration: none;
            font-weight: 600; transition: color .2s ease;
        }
        .auth-card .auth-footer a:hover { color: #2563eb; text-decoration: underline; }

        /* Alert styling */
        .auth-card .alert {
            border-radius: 12px; border: none; font-size: .84rem;
            backdrop-filter: blur(4px);
        }

        /* ── Responsive ── */
        @media (max-width: 992px) {
            .auth-brand { flex: 0 0 380px; padding: 2.5rem; }
            .auth-brand .brand-logo .auth-brand-text .auth-brand-name { font-size: 1.4rem; }
        }
        @media (max-width: 768px) {
            body { flex-direction: column; }
            .auth-brand {
                flex: none; padding: 2rem 1.5rem 1.5rem;
                align-items: center;
            }
            .auth-brand .brand-features { display: none; }
            .auth-brand .brand-divider { display: none; }
            .trust-badges { display: none; }
            .auth-card {
                padding: 2rem 1.5rem;
                border-radius: 20px 20px 0 0;
                max-width: 100%;
            }
            .auth-form-panel { padding: 0; align-items: flex-start; }
        }

        /* ── Subtle entrance animations for form fields ── */
        .auth-card .mb-3, .auth-card .mb-4 { animation: fieldAppear .5s ease-out both; }
        .auth-card .mb-3:nth-child(1) { animation-delay: .1s; }
        .auth-card .mb-3:nth-child(2) { animation-delay: .18s; }
        .auth-card .mb-3:nth-child(3) { animation-delay: .26s; }
        .auth-card .mb-4 { animation-delay: .34s; }

        @keyframes fieldAppear {
            from { opacity: 0; transform: translateY(8px); }
            to   { opacity: 1; transform: translateY(0); }
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Background effects -->
    <div class="auth-bg-canvas"></div>
    <div class="auth-orb auth-orb-1"></div>
    <div class="auth-orb auth-orb-2"></div>
    <div class="auth-orb auth-orb-3"></div>
    <div class="auth-grid-overlay"></div>

    <div class="auth-brand">
        <div class="brand-logo">
            <div class="auth-monogram">
                <svg class="logo-shape" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#3b82f6"/>
                            <stop offset="45%" stop-color="#4f46e5"/>
                            <stop offset="100%" stop-color="#7c3aed"/>
                        </linearGradient>
                        <linearGradient id="logoShine" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="rgba(255,255,255,.22)"/>
                            <stop offset="100%" stop-color="rgba(255,255,255,0)"/>
                        </linearGradient>
                    </defs>
                    <rect class="logo-bg" width="64" height="64" rx="18" ry="18"/>
                    <rect class="logo-inner-border" x="2" y="2" width="60" height="60" rx="16" ry="16"/>
                    <rect class="logo-shine" width="64" height="32" rx="18" ry="18"/>
                    <text class="logo-letters" x="32" y="33">KH</text>
                </svg>
            </div>
            <div class="auth-brand-text">
                <span class="auth-brand-name">Accounting Software</span>
                <span class="auth-brand-edition">Enterprise</span>
            </div>
        </div>
        <div class="brand-tagline">Professional accounting software<br>for every type of business</div>

        <div class="brand-divider"></div>

        <ul class="brand-features">
            <li>
                <span class="feature-icon"><i class="bi bi-check-lg"></i></span>
                Double-entry bookkeeping
            </li>
            <li>
                <span class="feature-icon"><i class="bi bi-check-lg"></i></span>
                Sales, purchases &amp; inventory
            </li>
            <li>
                <span class="feature-icon"><i class="bi bi-check-lg"></i></span>
                Industry-specific categories
            </li>
            <li>
                <span class="feature-icon"><i class="bi bi-check-lg"></i></span>
                Profit &amp; loss, balance sheet, cash flow
            </li>
            <li>
                <span class="feature-icon"><i class="bi bi-check-lg"></i></span>
                Multi-industry support
            </li>
        </ul>

        <div class="trust-badges">
            <div class="trust-badge">
                <div class="tb-icon"><i class="bi bi-shield-check"></i></div>
                <span class="tb-label">Secure</span>
            </div>
            <div class="trust-badge">
                <div class="tb-icon"><i class="bi bi-cloud-check"></i></div>
                <span class="tb-label">Cloud Sync</span>
            </div>
            <div class="trust-badge">
                <div class="tb-icon"><i class="bi bi-lightning-charge"></i></div>
                <span class="tb-label">Fast</span>
            </div>
        </div>
    </div>

    <div class="auth-form-panel">
        <div class="auth-card">
            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category if category != 'message' else 'info' }} alert-dismissible fade show py-2" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="alert" style="padding:.4rem;"></button>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            {% block content %}{% endblock %}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        /* Password visibility toggle */
        document.querySelectorAll('.pwd-toggle-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const input = this.closest('.pwd-field-wrap').querySelector('input');
                const icon = this.querySelector('i');
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.replace('bi-eye', 'bi-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.replace('bi-eye-slash', 'bi-eye');
                }
            });
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
